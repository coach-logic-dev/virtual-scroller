{"version":3,"sources":["../source/ReactVirtualScroller.js"],"names":["elementType","PropTypes","oneOfType","string","func","object","ReactVirtualScroller","props","React","createRef","Array","items","length","virtualScroller","updateLayout","onItemInitialRender","onItemFirstRender","shouldUpdateLayoutOnWindowResize","previousItemsProperty","generateUniquePrefix","createVirtualScroller","AsComponent","as","initialState","initialCustomState","onStateChange","estimatedItemHeight","preserveScrollPositionOfTheBottomOfTheListOnMount","preserveScrollPositionAtBottomOnMount","measureItemsBatchSize","scrollableContainer","getScrollableContainer","bypass","VirtualScroller","container","current","tbody","state","customState","getState","setState","newState","willUpdateState","didUpdateState","itemComponent","isComponentClass","i","getItemCoordinates","renderItem","shouldUseRefs","console","error","itemRefs","item","forceUpdate","_isMounted","indexOf","onItemHeightChange","onItemStateChange","itemState","prefix","String","Math","random","slice","uniquePrefixes","push","uniquePrefix","onMount","listen","prevProps","prevState","preserveScrollPosition","preserveScrollPositionOnPrependItems","setItems","stop","Component","itemComponentProps","_items","className","rest","itemStates","firstShownItemIndex","lastShownItemIndex","beforeItemsHeight","afterItemsHeight","newItems","previousItems","itemsPropertyWasChanged","prependedItemsCount","appendedItemsCount","captureScroll","paddingTop","undefined","paddingBottom","map","getItemRef","getOnItemStateChange","getOnItemHeightChange","arrayOf","isRequired","number","bool","any","shape","itemHeights","itemSpacing","prototype","isReactComponent"],"mappings":"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","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport VirtualScroller, { getItemsDiff } from './VirtualScroller'\nimport { px } from './utility'\n\n// `PropTypes.elementType` is available in some version of `prop-types`.\n// https://github.com/facebook/prop-types/issues/200\nconst elementType = PropTypes.elementType || PropTypes.oneOfType([\n\tPropTypes.string,\n\tPropTypes.func,\n\tPropTypes.object\n])\n\nexport default class ReactVirtualScroller extends React.Component {\n\tstatic propTypes = {\n\t\tas: elementType,\n\t\titems: PropTypes.arrayOf(PropTypes.object).isRequired,\n\t\titemComponent: elementType.isRequired,\n\t\titemComponentProps: PropTypes.object,\n\t\testimatedItemHeight: PropTypes.number,\n\t\tbypass: PropTypes.bool,\n\t\t// bypassBatchSize: PropTypes.number,\n\t\tpreserveScrollPositionOnPrependItems: PropTypes.bool,\n\t\t// `preserveScrollPosition` property name is deprecated,\n\t\t// use `preserveScrollPositionOnPrependItems` instead.\n\t\tpreserveScrollPosition: PropTypes.bool,\n\t\tpreserveScrollPositionOfTheBottomOfTheListOnMount: PropTypes.bool,\n\t\t// `preserveScrollPositionAtBottomOnMount` property name is deprecated,\n\t\t// use `preserveScrollPositionOfTheBottomOfTheListOnMount` property instead.\n\t\tpreserveScrollPositionAtBottomOnMount: PropTypes.bool,\n\t\tshouldUpdateLayoutOnWindowResize: PropTypes.func,\n\t\tmeasureItemsBatchSize: PropTypes.number,\n\t\tscrollableContainer: PropTypes.any,\n\t\t// `getScrollableContainer` property is deprecated.\n\t\t// Use `scrollableContainer` instead.\n\t\tgetScrollableContainer: PropTypes.func,\n\t\tclassName: PropTypes.string,\n\t\tonMount: PropTypes.func,\n\t\tonItemInitialRender: PropTypes.func,\n\t\t// `onItemFirstRender(i)` is deprecated, use `onItemInitialRender(item)` instead.\n\t\tonItemFirstRender: PropTypes.func,\n\t\tonStateChange: PropTypes.func,\n\t\tinitialCustomState: PropTypes.object,\n\t\tinitialState: PropTypes.shape({\n\t\t\titems: PropTypes.arrayOf(PropTypes.object).isRequired,\n\t\t\titemStates: PropTypes.arrayOf(PropTypes.any),\n\t\t\tfirstShownItemIndex: PropTypes.number.isRequired,\n\t\t\tlastShownItemIndex: PropTypes.number.isRequired,\n\t\t\tbeforeItemsHeight: PropTypes.number.isRequired,\n\t\t\tafterItemsHeight: PropTypes.number.isRequired,\n\t\t\titemHeights: PropTypes.arrayOf(PropTypes.number).isRequired,\n\t\t\titemSpacing: PropTypes.number\n\t\t})\n\t}\n\n\tstatic defaultProps = {\n\t\tas: 'div'\n\t}\n\n\t// `this.state` is already reserved for `virtual-scroller`.\n\t// static getDerivedStateFromProps(props, state) {\n\t// \treturn {\n\t// \t\tprevProps: {\n\t// \t\t\titems: props.items\n\t// \t\t}\n\t// \t}\n\t// }\n\n\tcontainer = React.createRef()\n\n\t// Handler function caches.\n\t// Just so that the props passed to `itemComponent`\n\t// are not changed on every `.render()` and so\n\t// `itemComponent` won't re-render if it's a `PureComponent`.\n\tonItemStateChange = new Array(this.props.items.length)\n\tonItemHeightChange = new Array(this.props.items.length)\n\n\t// Item refs for `.renderItem(i)`.\n\titemRefs = new Array(this.props.items.length)\n\n\t// List items are rendered with `key`s\n\t// so that React doesn't reuse `itemComponent`s\n\t// in cases when `items` are changed.\n\tuniquePrefixes = []\n\n\tconstructor(props) {\n\t\tsuper(props)\n\t\t// `this.previousItemsProperty` is only used for comparing\n\t\t// `previousItems` with `newItems` inside `render()`.\n\t\tthis.previousItemsProperty = props.items\n\t\t// Generate unique `key` prefix for list item components.\n\t\tthis.generateUniquePrefix()\n\t\t// Create `VirtualScroller` instance.\n\t\tthis.createVirtualScroller()\n\t}\n\n\tcreateVirtualScroller() {\n\t\tconst {\n\t\t\tas: AsComponent,\n\t\t\titems,\n\t\t\tinitialState,\n\t\t\tinitialCustomState,\n\t\t\tonStateChange,\n\t\t\testimatedItemHeight,\n\t\t\tpreserveScrollPositionOfTheBottomOfTheListOnMount,\n\t\t\t// `preserveScrollPositionAtBottomOnMount` property name is deprecated,\n\t\t\t// use `preserveScrollPositionOfTheBottomOfTheListOnMount` property instead.\n\t\t\tpreserveScrollPositionAtBottomOnMount,\n\t\t\tmeasureItemsBatchSize,\n\t\t\tscrollableContainer,\n\t\t\t// `getScrollableContainer` property is deprecated.\n\t\t\t// Use `scrollableContainer` instead.\n\t\t\tgetScrollableContainer,\n\t\t\tbypass,\n\t\t\t// bypassBatchSize\n\t\t} = this.props\n\t\t// Create `virtual-scroller` instance.\n\t\tthis.virtualScroller = new VirtualScroller(\n\t\t\t() => this.container.current,\n\t\t\titems,\n\t\t\t{\n\t\t\t\testimatedItemHeight,\n\t\t\t\tbypass,\n\t\t\t\t// bypassBatchSize,\n\t\t\t\tonItemInitialRender: this.onItemInitialRender,\n\t\t\t\t// `onItemFirstRender(i)` is deprecated, use `onItemInitialRender(item)` instead.\n\t\t\t\tonItemFirstRender: this.onItemFirstRender,\n\t\t\t\tpreserveScrollPositionOfTheBottomOfTheListOnMount,\n\t\t\t\t// `preserveScrollPositionAtBottomOnMount` property name is deprecated,\n\t\t\t\t// use `preserveScrollPositionOfTheBottomOfTheListOnMount` property instead.\n\t\t\t\tpreserveScrollPositionAtBottomOnMount,\n\t\t\t\tshouldUpdateLayoutOnWindowResize: this.shouldUpdateLayoutOnWindowResize,\n\t\t\t\tmeasureItemsBatchSize,\n\t\t\t\tscrollableContainer,\n\t\t\t\t// `getScrollableContainer` property is deprecated.\n\t\t\t\t// Use `scrollableContainer` instead.\n\t\t\t\tgetScrollableContainer,\n\t\t\t\ttbody: AsComponent === 'tbody',\n\t\t\t\tstate: initialState,\n\t\t\t\tcustomState: initialCustomState,\n\t\t\t\tonStateChange,\n\t\t\t\tgetState: () => this.state,\n\t\t\t\tsetState: (newState, { willUpdateState, didUpdateState }) => {\n\t\t\t\t\tthis.willUpdateState = willUpdateState\n\t\t\t\t\tthis.didUpdateState = didUpdateState\n\t\t\t\t\tif (this.state) {\n\t\t\t\t\t\t// Update existing state.\n\t\t\t\t\t\tthis.setState(newState)\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Set initial state.\n\t\t\t\t\t\twillUpdateState(newState)\n\t\t\t\t\t\tthis.state = newState\n\t\t\t\t\t\tdidUpdateState()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t}\n\n\t// This is a proxy for `VirtualScroller`'s `.updateLayout` instance method.\n\tupdateLayout = () => this.virtualScroller.updateLayout()\n\n\t// `.layout()` method name is deprecated, use `.updateLayout()` instead.\n\tlayout = () => this.updateLayout()\n\n\t// This proxy is required for cases when\n\t// `onItemInitialRender` property changes at subsequent renders.\n\t// For example, if it's passed as an \"anonymous\" function:\n\t// `<VirtualScroller onItemInitialRender={() => ...}/>`.\n\tonItemInitialRender = (...args) => {\n\t\tconst { onItemInitialRender } = this.props\n\t\tif (onItemInitialRender) {\n\t\t\tonItemInitialRender(...args)\n\t\t}\n\t}\n\n\t// This proxy is required for cases when\n\t// `onItemFirstRender` property changes at subsequent renders.\n\t// For example, if it's passed as an \"anonymous\" function:\n\t// `<VirtualScroller onItemFirstRender={() => ...}/>`.\n\t// `onItemFirstRender(i)` is deprecated, use `onItemInitialRender(item)` instead.\n\tonItemFirstRender = (...args) => {\n\t\tconst { onItemFirstRender } = this.props\n\t\tif (onItemFirstRender) {\n\t\t\tonItemFirstRender(...args)\n\t\t}\n\t}\n\n\t// This proxy is required for cases when\n\t// `shouldUpdateLayoutOnWindowResize` property changes at subsequent renders.\n\t// For example, if it's passed as an \"anonymous\" function:\n\t// `<VirtualScroller shouldUpdateLayoutOnWindowResize={() => ...}/>`.\n\tshouldUpdateLayoutOnWindowResize = (...args) => {\n\t\tconst { shouldUpdateLayoutOnWindowResize } = this.props\n\t\tif (shouldUpdateLayoutOnWindowResize) {\n\t\t\treturn shouldUpdateLayoutOnWindowResize(...args)\n\t\t}\n\t}\n\n\tshouldUseRefs() {\n\t\t// There's no way to detect if `ref` can be passed to `component`:\n\t\t// https://github.com/facebook/react/issues/16309\n\t\t// So only uses `ref`s for `React.Component`s.\n\t\tconst { itemComponent } = this.props\n\t\treturn isComponentClass(itemComponent)\n\t}\n\n\t/**\n\t * A proxy to `VirtualScroller.getItemCoordinates(i)`.\n\t * @param  {number} i\n\t * @return {object}\n\t */\n\tgetItemCoordinates(i) {\n\t\treturn this.virtualScroller.getItemCoordinates(i)\n\t}\n\n\t/**\n\t * `updateItem(i)` has been renamed to `renderItem(i)`.\n\t * @param {number} i\n\t */\n\tupdateItem(i) {\n\t\treturn this.renderItem(i)\n\t}\n\n\t/**\n\t * Re-renders an item.\n\t * @param {number} i\n\t */\n\trenderItem(i) {\n\t\tif (!this.shouldUseRefs()) {\n\t\t\treturn console.error('[virtual-scroller] `.renderItem(i)` has been called but the `component` doesn\\'t allow `ref`s. Only `component`s that\\'re `React.Component`s support this feature.')\n\t\t}\n\t\t// The item may be non-rendered when `.renderItem(i)` is called on it.\n\t\t// For example, when there's a \"parent comment\" having several \"replies\"\n\t\t// each of which has an autogenerated quote of the \"parent comment\"\n\t\t// and then the \"parent comment\" is updated (for example, a YouTube video\n\t\t// link gets parsed into an embedded video player) and all of its \"replies\"\n\t\t// should be updated too to show the parsed video title instead of the URL,\n\t\t// so `.renderItem(i)` is simply called on all of the \"parent post\"'s replies\n\t\t// regardless of some of those replies being rendered or not.\n\t\tif (this.itemRefs[i] && this.itemRefs[i].current) {\n\t\t\tconst { items } = this.props\n\t\t\t// Stores `item` here because the `i` index\n\t\t\t// might have changed when the callback is called,\n\t\t\t// or the item even may have been removed.\n\t\t\tconst item = items[i]\n\t\t\tthis.itemRefs[i].current.forceUpdate(() => {\n\t\t\t\tif (this._isMounted) {\n\t\t\t\t\t// Recalculates the `i` index here because it\n\t\t\t\t\t// might have changed when the callback is called,\n\t\t\t\t\t// or the item even may have been removed.\n\t\t\t\t\tconst i = items.indexOf(item)\n\t\t\t\t\tif (i >= 0) {\n\t\t\t\t\t\tthis.virtualScroller.onItemHeightChange(i)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\t// Functional components can't have a `ref` assigned to them.\n\t// Item `ref`s are only used for calling `.renderItem(i)` instance method.\n\t// If a developer is not using the `.renderItem(i)` instance method\n\t// then `ref`s aren't required and will be omitted.\n\tgetItemRef(i) {\n\t\tif (!this.itemRefs[i]) {\n\t\t\tthis.itemRefs[i] = React.createRef()\n\t\t}\n\t\treturn this.itemRefs[i]\n\t}\n\n\tgetOnItemStateChange(i) {\n\t\tif (!this.onItemStateChange[i]) {\n\t\t\tthis.onItemStateChange[i] = (itemState) => this.virtualScroller.onItemStateChange(i, itemState)\n\t\t}\n\t\treturn this.onItemStateChange[i]\n\t}\n\n\tgetOnItemHeightChange(i) {\n\t\tif (!this.onItemHeightChange[i]) {\n\t\t\tthis.onItemHeightChange[i] = () => this.virtualScroller.onItemHeightChange(i)\n\t\t}\n\t\treturn this.onItemHeightChange[i]\n\t}\n\n\tgenerateUniquePrefix() {\n\t\tconst prefix = String(Math.random()).slice(2)\n\t\tif (this.uniquePrefixes.indexOf(prefix) >= 0) {\n\t\t\treturn this.generateUniquePrefix()\n\t\t}\n\t\tthis.uniquePrefixes.push(prefix)\n\t\tthis.uniquePrefix = prefix\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { onMount } = this.props\n\t\t// `onMount()` option is deprecated due to no longer being used.\n\t\t// If someone thinks there's a valid use case for it, create an issue.\n\t\tif (onMount) {\n\t\t\tonMount()\n\t\t}\n\t\tthis._isMounted = true\n\t\t// Start listening to scroll events.\n\t\tthis.virtualScroller.listen()\n\t}\n\n\t// `getSnapshotBeforeUpdate()` is called right before `componentDidUpdate()`.\n\tgetSnapshotBeforeUpdate(prevProps, prevState) {\n\t\tif (this.state !== prevState) {\n\t\t\tthis.willUpdateState(this.state, prevState)\n\t\t}\n\t\t// Returns `null` to avoid React warning:\n\t\t// \"A snapshot value (or null) must be returned. You have returned undefined\".\n\t\treturn null\n\t}\n\n\t// `componentDidUpdate()` is called immediately after React component has re-rendered.\n\t// That would correspond to `useLayoutEffect()` in React Hooks.\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\t// If `state` did change.\n\t\tif (this.state !== prevState) {\n\t\t\tthis.didUpdateState(prevState)\n\t\t}\n\t\t// If `items` property did change then update `virtual-scroller` items.\n\t\t// This could have been done in `.render()` but `.setItems()` calls\n\t\t// `.setState()` internally which would result in React throwing an error.\n\t\tconst {\n\t\t\titems,\n\t\t\tpreserveScrollPosition,\n\t\t\tpreserveScrollPositionOnPrependItems\n\t\t} = this.props\n\t\tif (items !== prevProps.items) {\n\t\t\tthis.virtualScroller.setItems(items, {\n\t\t\t\t// `preserveScrollPosition` property name is deprecated,\n\t\t\t\t// use `preserveScrollPositionOnPrependItems` instead.\n\t\t\t\tpreserveScrollPositionOnPrependItems: preserveScrollPositionOnPrependItems || preserveScrollPosition\n\t\t\t})\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis._isMounted = false\n\t\t// Stop listening to scroll events.\n\t\tthis.virtualScroller.stop()\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tas: AsComponent,\n\t\t\titemComponent: Component,\n\t\t\titemComponentProps,\n\t\t\t// Rest\n\t\t\titems: _items,\n\t\t\testimatedItemHeight,\n\t\t\tbypass,\n\t\t\t// bypassBatchSize,\n\t\t\tpreserveScrollPositionOnPrependItems,\n\t\t\t// `preserveScrollPosition` property name is deprecated,\n\t\t\t// use `preserveScrollPositionOnPrependItems` instead.\n\t\t\tpreserveScrollPosition,\n\t\t\tpreserveScrollPositionOfTheBottomOfTheListOnMount,\n\t\t\t// `preserveScrollPositionAtBottomOnMount` property name is deprecated,\n\t\t\t// use `preserveScrollPositionOfTheBottomOfTheListOnMount` property instead.\n\t\t\tpreserveScrollPositionAtBottomOnMount,\n\t\t\tshouldUpdateLayoutOnWindowResize,\n\t\t\tmeasureItemsBatchSize,\n\t\t\tscrollableContainer,\n\t\t\t// `getScrollableContainer` property is deprecated.\n\t\t\t// Use `scrollableContainer` instead.\n\t\t\tgetScrollableContainer,\n\t\t\tinitialState,\n\t\t\tinitialCustomState,\n\t\t\tonStateChange,\n\t\t\tonItemInitialRender,\n\t\t\t// `onItemFirstRender(i)` is deprecated, use `onItemInitialRender(item)` instead.\n\t\t\tonItemFirstRender,\n\t\t\tonMount,\n\t\t\tclassName,\n\t\t\t...rest\n\t\t} = this.props\n\t\tconst {\n\t\t\titems,\n\t\t\titemStates,\n\t\t\tfirstShownItemIndex,\n\t\t\tlastShownItemIndex,\n\t\t\tbeforeItemsHeight,\n\t\t\tafterItemsHeight\n\t\t} = this.virtualScroller.getState()\n\t\t// If `items` are about to be changed then\n\t\t// store the scroll Y position for the first one\n\t\t// of the current items.\n\t\t// Previously it was being done in `componentDidUpdate()`\n\t\t// but it was later found out that it wouldn't work\n\t\t// for \"Show previous\" button because it would\n\t\t// get hidden before `componentDidUpdate()` is called.\n\t\t//\n\t\t// Consider this code example:\n\t\t//\n\t\t// const { fromIndex, items } = this.state\n\t\t// const items = allItems.slice(fromIndex)\n\t\t// return (\n\t\t// \t{fromIndex > 0 &&\n\t\t// \t\t<button onClick={this.onShowPrevious}>\n\t\t// \t\t\tShow previous\n\t\t// \t\t</button>\n\t\t// \t}\n\t\t// \t<VirtualScroller\n\t\t// \t\titems={items}\n\t\t// \t\titemComponent={ItemComponent}/>\n\t\t// )\n\t\t//\n\t\t// Consider a user clicks \"Show previous\" to show the items from the start.\n\t\t// By the time `componentDidUpdate()` is called on `<VirtualScroller/>`\n\t\t// the \"Show previous\" button has already been hidden\n\t\t// which results in the scroll Y position jumping forward\n\t\t// by the height of the \"Show previous\" button.\n\t\t// This is because `<VirtualScroller/>` restores scroll Y position\n\t\t// when items are prepended via `.setItems()` and it does that\n\t\t// when the \"Show previous\" button has already been hidden\n\t\t// so that's the reason for the scroll Y jump.\n\t\t//\n\t\t// To prevent that, scroll Y position is stored at `render()` time\n\t\t// rather than later in `componentDidUpdate()`.\n\t\t//\n\t\tconst newItems = this.props.items\n\t\tconst previousItems = items // this.virtualScroller.getState().items\n\t\t// There's one case when `newItems !== previousItems` is `true`\n\t\t// from the start: when `initialState.items` are passed.\n\t\t// To handle that single case `this.previousItemsProperty`\n\t\t// is tracked and `this.itemsPropertyHasChanged` flag is set.\n\t\tif (!this.itemsPropertyWasChanged) {\n\t\t\tthis.itemsPropertyWasChanged = this.props.items !== this.previousItemsProperty\n\t\t}\n\t\tthis.previousItemsProperty = this.props.items\n\t\tif (this.itemsPropertyWasChanged && newItems !== previousItems) {\n\t\t\tconst {\n\t\t\t\tprependedItemsCount,\n\t\t\t\tappendedItemsCount\n\t\t\t} = getItemsDiff(previousItems, newItems)\n\t\t\tif (prependedItemsCount === 0 && appendedItemsCount > 0) {\n\t\t\t\t// If it's just items that have been appended\n\t\t\t\t// then no need to re-generate the prefix\n\t\t\t\t// and to fix scroll position and to clear caches.\n\t\t\t} else {\n\t\t\t\t// `preserveScrollPosition` property name is deprecated,\n\t\t\t\t// use `preserveScrollPositionOnPrependItems` instead.\n\t\t\t\tif (preserveScrollPositionOnPrependItems || preserveScrollPosition) {\n\t\t\t\t\tthis.virtualScroller.captureScroll(\n\t\t\t\t\t\tpreviousItems,\n\t\t\t\t\t\tnewItems\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\t// Reset the unique `key` prefix for item component keys.\n\t\t\t\tthis.generateUniquePrefix()\n\t\t\t\t// Reset handler function caches.\n\t\t\t\tthis.onItemStateChange = new Array(newItems.length)\n\t\t\t\tthis.onItemHeightChange = new Array(newItems.length)\n\t\t\t\t// Reset item refs.\n\t\t\t\tthis.itemRefs = new Array(newItems.length)\n\t\t\t}\n\t\t}\n\t\tconst tbody = this.virtualScroller.tbody\n\t\treturn (\n\t\t\t<AsComponent\n\t\t\t\t{...rest}\n\t\t\t\tref={this.container}\n\t\t\t\tclassName={tbody ? (className ? className + ' ' + 'VirtualScroller' : 'VirtualScroller') : className}\n\t\t\t\tstyle={{\n\t\t\t\t\tpaddingTop: tbody ? undefined : px(beforeItemsHeight),\n\t\t\t\t\tpaddingBottom: tbody ? undefined : px(afterItemsHeight)\n\t\t\t\t}}>\n\t\t\t\t{items.map((item, i) => {\n\t\t\t\t\tif (i >= firstShownItemIndex && i <= lastShownItemIndex) {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Component\n\t\t\t\t\t\t\t\t{...itemComponentProps}\n\t\t\t\t\t\t\t\tref={this.shouldUseRefs() ? this.getItemRef(i) : undefined}\n\t\t\t\t\t\t\t\tkey={`${this.uniquePrefix}:${i}`}\n\t\t\t\t\t\t\t\tstate={itemStates && itemStates[i]}\n\t\t\t\t\t\t\t\tonStateChange={this.getOnItemStateChange(i)}\n\t\t\t\t\t\t\t\tonHeightChange={this.getOnItemHeightChange(i)}>\n\t\t\t\t\t\t\t\t{item}\n\t\t\t\t\t\t\t</Component>\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t\treturn null\n\t\t\t\t})}\n\t\t\t</AsComponent>\n\t\t)\n\t}\n}\n\n/**\n * Checks if the argument is a `React.Component` class.\n * https://overreacted.io/how-does-react-tell-a-class-from-a-function/\n * @param  {any}  Component\n * @return {object} [result] Returns `undefined` if it's not a `React.Component`. Returns an empty object if it's a `React.Component` (`.isReactComponent` is an empty object).\n */\nfunction isComponentClass(Component) {\n\t// return Component.prototype instanceof React.Component\n\t// `React.memo()` returns `.prototype === undefined` for some reason.\n\treturn Component.prototype && Component.prototype.isReactComponent\n}\n"],"file":"ReactVirtualScroller.js"}